"CreateCognitoPoolRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": { 
            "Version" : "2012-10-17",
            "Statement": [ {
                "Effect": "Allow",
                "Principal": {
                    "Service": [ "lambda.amazonaws.com" ]
                },
                "Action": [ "sts:AssumeRole" ]
            }]
        },
        "Path": "/",
        "ManagedPolicyArns":[
            "arn:aws:iam::aws:policy/CloudWatchLogsFullAccess"
        ],
        "Policies": [ 
            {
                "PolicyName":"CreateCognitoPool",
                "PolicyDocument":{
                    "Version": "2012-10-17",
                    "Statement": [
                    {
                        "Effect": "Allow",
                        "Action": [
                            "cognito-idp:CreateUserPool",  
                            "cognito-idp:CreateUserPoolClient", 
                            "cognito-idp:DeleteUserPool",  
                            "cognito-idp:DeleteUserPoolClient" 
                        ],
                        "Resource":"*"
                    }
                    ]
              }
            }

        ]
    }
},
"RDSProxyRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": { 
            "Version" : "2012-10-17",
            "Statement": [ {
                "Effect": "Allow",
                "Principal": {
                    "Service": [ "lambda.amazonaws.com" ]
                },
                "Action": [ "sts:AssumeRole" ]
            }]
        },
        "Path": "/",
        "ManagedPolicyArns":[
            "arn:aws:iam::aws:policy/CloudWatchLogsFullAccess",
            "arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
        ]
    }
},
"RDSlambdaSG":{
    "Type" : "AWS::EC2::SecurityGroup",
    "Properties" : {
        "GroupDescription":"na",
        "SecurityGroupIngress" : [],
        "VpcId" :{"Fn::ImportValue":
                    {"Fn::Sub":"${NetworkStackName}-VPC"}
                }
    }
},
"DBSG":{
    "Type" : "AWS::EC2::SecurityGroup",
    "Properties" : {
        "GroupDescription":"Allows traffic through load balancer",
        "SecurityGroupIngress" : [ 
            {
                "SourceSecurityGroupId":{"Ref":"RDSlambdaSG"}, 
                "FromPort" : "3306",
                "ToPort" : "3306",
                "IpProtocol" : "tcp"
            }
        ],
        "VpcId" :{"Fn::ImportValue":
                    {"Fn::Sub":"${NetworkStackName}-VPC"}
                }
    }
},
"CreateCognitoIdentityRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": { 
            "Version" : "2012-10-17",
            "Statement": [ {
                "Effect": "Allow",
                "Principal": {
                    "Service": [ "lambda.amazonaws.com" ]
                },
                "Action": [ "sts:AssumeRole" ]
            }]
        },
        "Path": "/",
        "ManagedPolicyArns":[
            "arn:aws:iam::aws:policy/CloudWatchLogsFullAccess"
        ],
        "Policies": [ 
            {
                "PolicyName":"CreateCognitoPool",
                "PolicyDocument":{
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "Stmt1482095556000",
                            "Effect": "Allow",
                            "Action": [
                                "cognito-identity:CreateIdentityPool",
                                "cognito-identity:DeleteIdentityPool",
                                "cognito-identity:SetIdentityPoolRoles",
                                "iam:PassRole"
                            ],
                            "Resource": [
                                "*"
                            ]
                        }
                    ]
                }
            }
        ]
    }
},
"AdminRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Principal": {
                    "Federated": "cognito-identity.amazonaws.com"
                  },
                  "Action": "sts:AssumeRoleWithWebIdentity",
                  "Condition": {
                    "StringEquals": {
                      "cognito-identity.amazonaws.com:aud": "test"
                    }
                  }
                }
              ]
            },
        "Path": "/",
        "ManagedPolicyArns":[
            "arn:aws:iam::aws:policy/CloudWatchLogsFullAccess"
        ],
        "Policies": [ 
        ]
    }
},
"RequesterRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Principal": {
                    "Federated": "cognito-identity.amazonaws.com"
                  },
                  "Action": "sts:AssumeRoleWithWebIdentity",
                  "Condition": {
                    "StringEquals": {
                      "cognito-identity.amazonaws.com:aud": "test"
                    }
                  }
                }
              ]
            },
        "Path": "/",
        "ManagedPolicyArns":[
            "arn:aws:iam::aws:policy/CloudWatchLogsFullAccess"
        ],
        "Policies": [ 
        ]
    }
},
"OberserverRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Principal": {
                    "Federated": "cognito-identity.amazonaws.com"
                  },
                  "Action": "sts:AssumeRoleWithWebIdentity",
                  "Condition": {
                    "StringEquals": {
                      "cognito-identity.amazonaws.com:aud": "test"
                    }
                  }
                }
              ]
            },
        "Path": "/",
        "ManagedPolicyArns":[
            "arn:aws:iam::aws:policy/CloudWatchLogsFullAccess"
        ],
        "Policies": [ 
        ]
    }
},
"unauthenticatedRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Principal": {
                    "Federated": "cognito-identity.amazonaws.com"
                  },
                  "Action": "sts:AssumeRoleWithWebIdentity",
                  "Condition": {
                    "StringEquals": {
                      "cognito-identity.amazonaws.com:aud": "test"
                    }
                  }
                }
              ]
            },
        "Path": "/",
        "Policies": [ 
        ]
    }
},
"ApiGatewayRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": { 
            "Version" : "2012-10-17",
            "Statement": [ {
                "Effect": "Allow",
                "Principal": {
                    "Service": [ "apigateway.amazonaws.com" ]
                },
                "Action": [ "sts:AssumeRole" ]
            }]
        },
        "Path": "/",
        "ManagedPolicyArns":[],
        "Policies": [
            {
                "PolicyName":"CreateCognitoPool",
                "PolicyDocument":{
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "Stmt1482095556000",
                            "Effect": "Allow",
                            "Action": [
                                "lambda:invokeFunction"
                            ],
                            "Resource": [
                                "*"
                            ]
                        }
                    ]
                }
            }

        
        
        ]
    }
},
"BuildRole":{
    "Type": "AWS::IAM::Role",
    "Properties": {
         "AssumeRolePolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Principal": {
                    "Service": "codebuild.amazonaws.com"
                  },
                  "Action": "sts:AssumeRole"
                }
              ]
            },
        "Path": "/",
        "Policies": [{
            "PolicyName":"CreateCognitoPool",
            "PolicyDocument":{
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Sid": "CloudWatchLogsPolicy",
                        "Effect": "Allow",
                        "Action": [
                            "logs:CreateLogGroup",
                            "logs:CreateLogStream",
                            "logs:PutLogEvents"
                        ],
                        "Resource": [
                            "arn:aws:logs:us-east-1:677241476911:log-group:/aws/codebuild/websiteBuild"
                        ]
                    },
                    {
                        "Sid": "CodeCommitPolicy",
                        "Effect": "Allow",
                        "Action": [
                            "codecommit:GitPull"
                        ],
                        "Resource": [
                            "*"
                        ]
                    },
                    {
                        "Sid": "S3GetObjectPolicy",
                        "Effect": "Allow",
                        "Action": [
                            "s3:GetObject",
                            "s3:GetObjectVersion"
                        ],
                        "Resource": [
                            "*"
                        ]
                    },
                    {
                        "Sid": "S3PutObjectPolicy",
                        "Effect": "Allow",
                        "Action": [
                            "s3:PutObject"
                        ],
                        "Resource": [
                            "*"
                        ]
                    }
                ]
            } 
		}]
    }
}
