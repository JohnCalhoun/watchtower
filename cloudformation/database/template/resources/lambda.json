"InitDataBase":{
      "Type" : "AWS::Lambda::Function",
      "Properties" : {
        "Code" : {
            "S3Bucket":{"Ref":"ArtifactsBucket"},
            "S3Key":"watchtower/lambda/lambda-initdatabase_latest.zip"
        },
        "FunctionName":{"Fn::Join":["-",[
                "initdatabase", 
                {"Ref":"AWS::StackName"}
            ]]},
        "Handler" : "handler.handler",
        "MemorySize" : "128",
        "Role" : {"Fn::GetAtt":["LambdaEncrypt","Arn"]},
        "Runtime" : "nodejs4.3",
        "Timeout" : "100",
        "VpcConfig":{
            "SecurityGroupIds":[
                {"Ref":"RDSlambdaSG"} 
            ],
            "SubnetIds":[
                {"Fn::Join":["",[
                    {"Fn::ImportValue":
                        {"Fn::Sub":"${NetworkStackName}-subnet1"}
                    }
                ]]}
                ,
                {"Fn::Join":["",[
                    {"Fn::ImportValue":
                        {"Fn::Sub":"${NetworkStackName}-subnet2"}
                    }
                ]]}
            ]
        },
        "Environment":{
            "Variables":{
                "DB_ENDPOINT":{"Fn::GetAtt":["DB","Endpoint.Address"]},
                "DB_USER":{ "Ref" : "DBMasterUser" },
                "DB_PASSWORD":{ "Ref" : "DBMasterPassword" },
                "DB_NAME":{ "Ref" : "DBName" },
                "KMS_KEY":{"Fn::GetAtt":["key","Arn"]}
            }
        }
    }
}        
