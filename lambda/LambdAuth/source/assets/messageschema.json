{"anyOf":[
    {
        "type":"object",
        "properties":{
            "action":{
                "type":"string",
                "enum":["create"]
            },
            "id":{
                "type":"string",
                "pattern":"^[A-Za-z][A-Za-z0-9._]{3,30}$"
            },
            "newId":{
                "type":"string",
                "pattern":"^[A-Za-z][A-Za-z0-9._]{3,30}$"
            },
            "email":{
                "type":"string",
                "format":"email"
            },
            "B":{
                "type":"sting",
                "minLength":"512",
                "pattern":"^[0-9a-fA-F]+$"
            },
            "group":{
                "type":"sting",
                "enum":["admin","user"]
            },
            "hotp":{
                "type":"sting",
                "minLength":"1",
                "pattern":"^[0-9a-fA-F]+$"
            },
            "messageId":{
                "type":"string"
            }
        },
        "required":[
            "action","id","newId","email","B","group","hotp","messageId"
        ],
        "additionalProperties":false},
    {
        "type":"object",
        "properties":{
            "action":{
                "type":"string",
                "enum":["changePassword"]
            },
            "id":{
                "type":"string",
                "pattern":"^[A-Za-z][A-Za-z0-9._]{3,14}$"
            },
            "salt":{
                "type":"sting",
                "minLength":64,
                "pattern":"^[0-9a-fA-F]+$"
            },
            "verifier":{
                "type":"sting",
                "minLength":"512",
                "pattern":"^[0-9a-fA-F]+$"
            }
        },
        "required":[
            "action","id","salt","verifier"
        ],
        "additionalProperties":false},
    {
        "type":"object",
        "properties":{
            "action":{
                "type":"string",
                "enum":["createMFA","valMFA","session","get"]
            },
            "id":{
                "type":"string",
                "pattern":"^[A-Za-z][A-Za-z0-9._]{3,30}$"
            },
            "token":{
                "type":"sting",
                "pattern":"^[0-9]{6,6}$"
            },
            "B":{
                "type":"sting",
                "minLength":"512",
                "pattern":"^[0-9a-fA-F]+$"
            },
            "hotp":{
                "type":"sting",
                "minLength":"1",
                "pattern":"^[0-9a-fA-F]+$"
            },
            "messageId":{
                "type":"string"
            }
        },
        "required":[
            "action","id","B","hotp","messageId"
        ],
        "additionalProperties":false},
    {
        "type":"object",
        "properties":{
            "action":{
                "type":"string",
                "enum":["changeEmail"]
            },
            "id":{
                "type":"string",
                "pattern":"^[A-Za-z][A-Za-z0-9._]{3,30}$"
            },
            "email":{
                "type":"string",
                "format":"email"
            }
        },
        "required":[
            "action","id","email"
        ],
        "additionalProperties":false},
    {
        "type":"object",
        "properties":{
            "action":{
                "type":"string",
                "enum":["resetPassword","createMFA","delete"]
            },
            "id":{
                "type":"string",
                "pattern":"^[A-Za-z][A-Za-z0-9._]{3,30}$"
            }
        },
        "required":[
            "action","id"
        ],
        "additionalProperties":false}    
]}
